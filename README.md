
# (Drawing Management)

این پروژه یک برنامه ساده مبتنی بر Spring Boot است که برای ذخیره و بازیابی نقاشی‌ها (drawings) همراه با اشکال (shapes) طراحی شده است. از JPA برای ارتباط با پایگاه داده استفاده می‌کند و APIهای RESTful برای عملیات ذخیره و بازیابی ارائه می‌دهد. پروژه شامل مدل‌های داده، DTOها، سرویس، کنترلر و ریپازیتوری است.


## ساختار پروژه
پروژه در پکیج `org.example.hw3` سازماندهی شده است و شامل کلاس‌های زیر می‌شود:

### 1. DrawingController.java
این کلاس یک کنترلر RESTful است که در مسیر `/api/drawings` عمل می‌کند. مسئولیت آن مدیریت درخواست‌های HTTP برای ذخیره و بازیابی نقاشی‌ها است:
- متد `save`: با استفاده از POST، نقاشی را بر اساس نام کاربری ذخیره می‌کند.
- متد `restore`: با استفاده از GET، نقاشی ذخیره‌شده را بر اساس نام کاربری بازیابی می‌کند.
  این کلاس از سرویس `DrawingService` برای عملیات اصلی استفاده می‌کند و از Cross-Origin برای اجازه دسترسی از frontend  پشتیبانی می‌کند.

### 2. DrawingDto.java
این کلاس یک DTO (Data Transfer Object) برای انتقال داده‌های نقاشی بین لایه‌ها است. شامل فیلدهای `name` (نام نقاشی) و `shapes` (لیستی از ShapeDtoها) می‌شود. getter و setter برای دسترسی به این فیلدها فراهم شده است. این کلاس برای جلوگیری از انتقال مستقیم مدل‌های پایگاه داده به کلاینت استفاده می‌شود.

### 3. ShapeDto.java
این کلاس یک DTO برای اشکال است. شامل فیلدهایی مانند `id`، `type` (نوع شکل)، `x` و `y` (مختصات) می‌شود. getter و setter برای مدیریت این فیلدها وجود دارد. این DTO برای انتقال داده‌های اشکال بین سرویس و کنترلر استفاده می‌شود و جزئیات پیاده‌سازی پایگاه داده را پنهان می‌کند.

### 4. Shape.java
این کلاس یک مدل Entity برای اشکال در پایگاه داده است که به جدول `shape` مپ می‌شود. شامل فیلدهای `id` (کلید اصلی، خودکار تولیدشده)، `type` (نوع شکل)، `x` و `y` (مختصات)، و رابطه Many-to-One با کلاس `Drawing` (از طریق `drawing_id`). از FetchType.LAZY برای بارگذاری تنبل استفاده می‌کند. getter و setter برای تمام فیلدها فراهم شده است. این کلاس برای ذخیره اشکال در پایگاه داده استفاده می‌شود.

### 5. Drawing.java
این کلاس یک مدل Entity برای نقاشی‌ها است که به جدول `drawing` مپ می‌شود. شامل فیلدهای `id` (کلید اصلی)، `username` (نام کاربری، منحصربه‌فرد)، `name` (نام نقاشی)، و لیستی از `shapes` (رابطه One-to-Many با کلاس Shape). از CascadeType.ALL برای مدیریت خودکار اشکال وابسته استفاده می‌کند. getter و setter برای مدیریت فیلدها و لیست اشکال وجود دارد. این کلاس هسته ذخیره‌سازی نقاشی‌ها در پایگاه داده است.

### 6. DrawingRepository.java
این اینترفیس یک ریپازیتوری JPA برای کلاس `Drawing` است که از `JpaRepository` ارث‌بری می‌کند. متدهای استاندارد CRUD را فراهم می‌کند و همچنین متد سفارشی `findByUsername` برای جستجو بر اساس نام کاربری. این ریپازیتوری برای دسترسی به داده‌های پایگاه داده بدون نوشتن کوئری‌های SQL استفاده می‌شود.

### 7. DrawingService.java
این کلاس سرویس اصلی پروژه است که عملیات бизнес لاجیک را مدیریت می‌کند. شامل متدهای:
- `saveDrawing`: نقاشی را ذخیره یا به‌روزرسانی می‌کند، اشکال را به entity تبدیل کرده و در پایگاه داده ذخیره می‌کند.
- `getDrawing`: نقاشی را بر اساس نام کاربری بازیابی کرده و به DTO تبدیل می‌کند.
  از تراکنش‌ها (`@Transactional`) برای اطمینان از اتمی‌بودن عملیات استفاده می‌کند و از ریپازیتوری `DrawingRepository` برای دسترسی به داده‌ها بهره می‌برد.

## نحوه اجرا
1. پروژه را با Maven یا Gradle بیلد کنید.
2. پایگاه داده را تنظیم کنید (در `application.properties`).
